---
title: Link Slider
layout: default
parent: Blog
---

# Link Slider
こちらのサイトになります。renderというホスティングサービスを使用しています。初回立ち上げに少々時間がかかります。

<a href="https://link-slider.onrender.com/" target="_blank">Link Slider</a>

## 動機

よくwebゲームで1台のPCで2人対戦可能!!みたいなものがあるが、実際に対面であって遊ぶことはかなり限られてくるため、オンライン対戦に対応しようと思って作成したのがこのゲームになります。

モデルは小学生のときにハマったアニメで使用されていたパズルゲームです。

## ルール

赤、青はそれぞれプレイヤー1、プレイヤー2を表現しています。紫はゴールを表しています。

7 x 7の氷のマスの上に、16枚のボード(初期位置固定12枚 + ランダム4枚)が設置されています。7 x 7のマスの外周は壁に覆われています。

1. プレイヤーは現在いる位置から隣接するボードに自由に移動することができ、使用するボードをEnterで決定します。

2. 使用するボードを決定した後、上下左右の4方向の中から移動したい方向を選択してボードと共に移動します。

3. ボードは壁またはボードに衝突することで停止します。

4. 1〜3を交互に繰り返し、先に紫のマス上でピッタリ止まることができたプレイヤーの勝利です。

## 実装

### 相互通信
相互通信についてはSocket.ioに関する文献を読み漁った。

クライアントとサーバーの相互通信をSocket.ioによって確立し、オンライン対戦ゲームを実現した。(何もしなければ、リアルタイム性も確保できるはず。今回は思考を相手に隠すために通信するタイミングを制限していたような...)

### 2人対戦
何も制限しないとサイトに接続した人全員で対戦できるような状況になる。

今回は2人対戦なので、6桁の数字を入力(動物タワーバトルなどを参考にした)という認証ページを作成し、ゲームIDとソケットIDを対応づけることによって通信先を選択している。

ゲームIDには他にも盤面が紐づけられてたりとコードをみると結構面白い。

### 描写 バックエンド

描写はCanvasを使用。バックエンドは簡単な処理なのでJavaScriptを使用して書いている。

## 問題点

通信が切れた時は、対戦相手が逃げたと判定してゲームのデータを削除するようなコードを書いたので、通信不良などが起こるとゲームが初期化されてしまう。結構致命的な問題。

5秒間通信がない場合は、などといった実装に変更した方が良さそう。

オンライン対戦ゲームを実現したい!!という動機で作成したものなので、結構コードがひどい。時間ある時に補修しようと思う。

